# Chat2Repo 对话聊天页面

## 概述

Chat2Repo 现在提供了一个交互式的 Web 对话聊天页面，让用户可以直接在浏览器中与 AI Agent 进行对话，讨论开源解决方案或探讨特定仓库的实现细节。

## 功能特性

### 🎯 双模式对话

#### 1. 技术问答模式
- **功能**：搜索 Gitee 上的开源解决方案
- **适用场景**：
  - 寻找特定技术栈的开源项目
  - 了解某个技术问题的解决方案
  - 探索不同的开源框架和库
- **特色**：支持按编程语言筛选（Python、JavaScript、Java、Go 等）

#### 2. 仓库对话模式
- **功能**：深入分析特定 Gitee 仓库
- **适用场景**：
  - 了解仓库的代码结构
  - 查询具体文件内容
  - 分析提交历史
  - 理解项目实现细节
- **配置项**：
  - 仓库所有者（必填）
  - 仓库名称（必填）
  - 分支/标签（可选）

### 💬 智能对话体验

- **实时消息**：即时显示用户和 AI 的对话内容
- **Markdown 支持**：
  - 代码块高亮显示
  - 行内代码标记
  - 链接和粗体文本
- **工具调用追踪**：显示 Agent 执行的工具调用信息
- **加载动画**：优雅的打字动画，提升用户体验

### 📚 会话管理

- **会话历史**：自动保存所有对话会话
- **会话恢复**：随时切换和恢复之前的对话
- **新建会话**：一键开始新的对话主题
- **会话列表**：侧边栏显示所有历史会话，包含时间和消息数量

### 🎨 用户界面

- **响应式设计**：适配桌面和移动设备
- **现代化 UI**：
  - 清晰的视觉层次
  - 流畅的动画效果
  - 舒适的配色方案
- **便捷操作**：
  - Enter 发送消息
  - Shift + Enter 换行
  - 快速示例问题
  - 自动滚动到最新消息

## 访问方式

### 启动服务

```bash
# 1. 配置环境变量
cp .env.example .env
# 编辑 .env 文件，填入必要的 API 密钥

# 2. 启动服务器
python main.py
# 或使用
uvicorn main:app --reload
```

### 访问地址

- **首页**：http://localhost:8000/
- **聊天页面**：http://localhost:8000/static/chat.html

## 使用示例

### 技术问答示例

1. 选择"技术问答"模式
2. （可选）选择编程语言筛选
3. 输入问题，例如：
   - "如何实现一个分布式任务调度系统？"
   - "有哪些优秀的微服务框架？"
   - "推荐一些机器学习的开源项目"

### 仓库对话示例

1. 选择"仓库对话"模式
2. 填写仓库信息：
   - 仓库所有者：`openharmony`
   - 仓库名称：`docs`
   - 分支：`master`（可选）
3. 输入问题，例如：
   - "这个项目的主要目录结构是什么？"
   - "README.md 文件的内容是什么？"
   - "最近有哪些重要的提交？"

## 技术架构

### 前端技术

- **纯原生 JavaScript**：无依赖，轻量级
- **CSS3**：现代化样式和动画
- **Fetch API**：异步通信

### 后端集成

- **FastAPI**：RESTful API
- **会话管理**：内存存储（可扩展为数据库）
- **静态文件服务**：自动挂载 `/static` 目录

### 文件结构

```
static/
├── index.html      # 首页
├── chat.html       # 聊天页面
├── chat.css        # 聊天页面样式
├── chat.js         # 聊天页面逻辑
└── style.css       # 全局样式
```

## API 端点

聊天页面使用以下 API 端点：

### POST /api/chat/tech
技术问答接口

**请求体**：
```json
{
  "question": "如何实现分布式锁？",
  "language": "Python",
  "session_id": "optional_session_id"
}
```

### POST /api/chat/repo
仓库对话接口

**请求体**：
```json
{
  "repo_owner": "openharmony",
  "repo_name": "docs",
  "question": "项目结构是怎样的？",
  "ref": "master",
  "session_id": "optional_session_id"
}
```

### GET /api/sessions
获取所有会话列表

### GET /api/sessions/{session_id}
获取特定会话的历史记录

### DELETE /api/sessions/{session_id}
删除特定会话

## 自定义和扩展

### 修改样式

编辑 `static/chat.css` 文件可以自定义：
- 颜色主题
- 布局尺寸
- 动画效果
- 响应式断点

### 添加功能

编辑 `static/chat.js` 文件可以：
- 添加新的消息格式
- 自定义快捷操作
- 集成其他 API
- 添加数据持久化

### 扩展后端

编辑 `main.py` 可以：
- 添加新的 API 端点
- 实现数据库存储
- 添加用户认证
- 集成更多数据源

## 注意事项

1. **API 密钥**：确保在 `.env` 文件中配置了有效的 API 密钥
2. **网络请求**：需要网络连接以访问 Gitee API 和 LLM 服务
3. **会话存储**：当前使用内存存储，服务器重启后会话将丢失
4. **性能优化**：对于大型仓库，查询可能需要较长时间

## 未来改进

- [ ] 添加用户认证和授权
- [ ] 实现数据库持久化存储
- [ ] 支持多人协作对话
- [ ] 添加代码编辑器集成
- [ ] 实现实时推送（WebSocket）
- [ ] 支持文件上传和分析
- [ ] 添加对话导出功能
- [ ] 支持自定义 Agent 配置

## 贡献

欢迎提交 Issue 和 Pull Request 来改进聊天页面的功能和体验！
